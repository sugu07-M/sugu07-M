CREATE VIEW [IT].[vw_BarchartValue] AS
SELECT 
    COUNT(CASE WHEN Status = 'Completed' THEN ITCRID END) AS CompletedIDNum,
    COUNT(CASE WHEN Status != 'Completed' THEN ITCRID END) AS NonCompletedIDNum,
    DATEPART(MM, crdate) AS crmonth  
FROM 
    IT.ChangeRequest  
WHERE 
    DATEPART(MM, crdate) BETWEEN DATEPART(MM, GETDATE()) - 6 AND DATEPART(MM, GETDATE())
GROUP BY 
    DATEPART(MM, crdate);


SELECT *
FROM [IT].[vw_BarchartValue]
ORDER BY crmonth DESC;
